{"version":3,"sources":["../../../src/journals/validators/WGS84.validator.ts"],"sourcesContent":["import {\n    ValidationArguments,\n    ValidationOptions,\n    ValidatorConstraint,\n    ValidatorConstraintInterface,\n    registerDecorator,\n} from 'class-validator';\n\n@ValidatorConstraint({ async: false })\nexport class IsWGS84Constraint implements ValidatorConstraintInterface {\n    private regexWgs84 = /^-?\\d+\\.*\\d*/;\n\n    private checkWGS84Range(coord: number, type: 'lat' | 'lng'): boolean {\n        if (type == 'lat') {\n            return coord >= -90 && coord <= 90;\n        } else {\n            return coord >= -180 && coord <= 180;\n        }\n    }\n\n    private isValidateCoordinate(coord: number, type: 'lat' | 'lng'): boolean {\n        if (typeof coord !== 'number' || !this.regexWgs84.test(coord.toString())) {\n            return false;\n        }\n\n        return this.checkWGS84Range(coord, type);\n    }\n\n    validate(value: [number, number][]): boolean {\n        if (!Array.isArray(value)) {\n            return false;\n        }\n\n        for (const cur of value) {\n            if (!Array.isArray(cur) || cur.length !== 2) {\n                return false;\n            }\n            return this.isValidateCoordinate(cur[0], 'lat') && this.isValidateCoordinate(cur[1], 'lng');\n        }\n        return true;\n    }\n\n    defaultMessage(validationArguments?: ValidationArguments | undefined): string {\n        if (validationArguments) {\n            for (const cur of validationArguments.value) {\n                if (typeof cur[0] !== 'number' || typeof cur[1] !== 'number') {\n                    return '요소의 타입이 number가 아닙니다';\n                }\n                if (!this.checkWGS84Range(cur[0], 'lat') || !this.checkWGS84Range(cur[1], 'lng')) {\n                    return 'WGS84 범위를 벗어나는 숫자입니다. lat : -90 ~ 90, lng: -180 ~ 180';\n                }\n            }\n        }\n        return 'WGS84 포맷을 따르는 number로 이루어진 길이 2의 배열이어야 합니다';\n    }\n}\n\nexport function IsWGS84(validationOptions?: ValidationOptions) {\n    return function (object: object, propertyName: string) {\n        registerDecorator({\n            target: object.constructor,\n            propertyName: propertyName,\n            options: validationOptions,\n            constraints: [],\n            validator: IsWGS84Constraint,\n        });\n    };\n}\n"],"names":["IsWGS84","IsWGS84Constraint","checkWGS84Range","coord","type","isValidateCoordinate","regexWgs84","test","toString","validate","value","Array","isArray","cur","length","defaultMessage","validationArguments","ValidatorConstraint","async","validationOptions","object","propertyName","registerDecorator","target","constructor","options","constraints","validator"],"rangeMappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;","mappings":";;;;;;;;IAyDgBA,OAAO;eAAPA;;IAhDHC,iBAAiB;eAAjBA;;;gCAHN;;;;;;;AAGA,IAAA,AAAMA,oBAAN,MAAMA;IAGDC,gBAAgBC,KAAa,EAAEC,IAAmB,EAAW;QACjE,IAAIA,QAAQ,OAAO;YACf,OAAOD,SAAS,CAAC,MAAMA,SAAS;QACpC,OAAO;YACH,OAAOA,SAAS,CAAC,OAAOA,SAAS;QACrC;IACJ;IAEQE,qBAAqBF,KAAa,EAAEC,IAAmB,EAAW;QACtE,IAAI,OAAOD,UAAU,YAAY,CAAC,IAAI,CAACG,UAAU,CAACC,IAAI,CAACJ,MAAMK,QAAQ,KAAK;YACtE,OAAO;QACX;QAEA,OAAO,IAAI,CAACN,eAAe,CAACC,OAAOC;IACvC;IAEAK,SAASC,KAAyB,EAAW;QACzC,IAAI,CAACC,MAAMC,OAAO,CAACF,QAAQ;YACvB,OAAO;QACX;QAEA,KAAK,MAAMG,OAAOH,MAAO;YACrB,IAAI,CAACC,MAAMC,OAAO,CAACC,QAAQA,IAAIC,MAAM,KAAK,GAAG;gBACzC,OAAO;YACX;YACA,OAAO,IAAI,CAACT,oBAAoB,CAACQ,GAAG,CAAC,EAAE,EAAE,UAAU,IAAI,CAACR,oBAAoB,CAACQ,GAAG,CAAC,EAAE,EAAE;QACzF;QACA,OAAO;IACX;IAEAE,eAAeC,mBAAqD,EAAU;QAC1E,IAAIA,qBAAqB;YACrB,KAAK,MAAMH,OAAOG,oBAAoBN,KAAK,CAAE;gBACzC,IAAI,OAAOG,GAAG,CAAC,EAAE,KAAK,YAAY,OAAOA,GAAG,CAAC,EAAE,KAAK,UAAU;oBAC1D,OAAO;gBACX;gBACA,IAAI,CAAC,IAAI,CAACX,eAAe,CAACW,GAAG,CAAC,EAAE,EAAE,UAAU,CAAC,IAAI,CAACX,eAAe,CAACW,GAAG,CAAC,EAAE,EAAE,QAAQ;oBAC9E,OAAO;gBACX;YACJ;QACJ;QACA,OAAO;IACX;;aA5CQP,aAAa;;AA6CzB;AA9CaL;IADZgB,IAAAA,mCAAmB,EAAC;QAAEC,OAAO;IAAM;GACvBjB;AAgDN,SAASD,QAAQmB,iBAAqC;IACzD,OAAO,SAAUC,MAAc,EAAEC,YAAoB;QACjDC,IAAAA,iCAAiB,EAAC;YACdC,QAAQH,OAAOI,WAAW;YAC1BH,cAAcA;YACdI,SAASN;YACTO,aAAa,EAAE;YACfC,WAAW1B;QACf;IACJ;AACJ"}